{"remainingRequest":"E:\\订单\\毕业设计\\校园失误招领系统\\Miraitowa-4.10\\代码\\springboot38tp1\\src\\main\\resources\\front\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\订单\\毕业设计\\校园失误招领系统\\Miraitowa-4.10\\代码\\springboot38tp1\\src\\main\\resources\\front\\front\\src\\components\\FileUpload.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\订单\\毕业设计\\校园失误招领系统\\Miraitowa-4.10\\代码\\springboot38tp1\\src\\main\\resources\\front\\front\\src\\components\\FileUpload.vue","mtime":1672050572000},{"path":"E:\\订单\\毕业设计\\校园失误招领系统\\Miraitowa-4.10\\代码\\springboot38tp1\\src\\main\\resources\\front\\front\\node_modules\\babel-loader\\lib\\index.js","mtime":1710318987774},{"path":"E:\\订单\\毕业设计\\校园失误招领系统\\Miraitowa-4.10\\代码\\springboot38tp1\\src\\main\\resources\\front\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1710318967506},{"path":"E:\\订单\\毕业设计\\校园失误招领系统\\Miraitowa-4.10\\代码\\springboot38tp1\\src\\main\\resources\\front\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":1710318977016}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgc3RvcmFnZSBmcm9tICJAL2NvbW1vbi9zdG9yYWdlIjsNCmltcG9ydCBjb25maWcgZnJvbSAiQC9jb25maWcvY29uZmlnIjsNCmV4cG9ydCBkZWZhdWx0IHsNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgYmFzZVVybDogY29uZmlnLmJhc2VVcmwsDQogICAgICAvLyDmn6XnnIvlpKflm74NCiAgICAgIGRpYWxvZ1Zpc2libGU6IGZhbHNlLA0KICAgICAgLy8g5p+l55yL5aSn5Zu+DQogICAgICBkaWFsb2dJbWFnZVVybDogIiIsDQogICAgICAvLyDnu4Tku7bmuLLmn5Plm77niYfnmoTmlbDnu4TlrZfmrrXvvIzmnInnibnmrormoLzlvI/opoHmsYINCiAgICAgIGZpbGVMaXN0OiBbXSwNCiAgICAgIGZpbGVVcmxMaXN0OiBbXSwNCiAgICAgIG15SGVhZGVyczp7fQ0KICAgIH07DQogIH0sDQogIHByb3BzOiBbInRpcCIsICJhY3Rpb24iLCAibGltaXQiLCAibXVsdGlwbGUiLCAiZmlsZVVybHMiXSwNCiAgbW91bnRlZCgpIHsNCiAgICB0aGlzLmluaXQoKTsNCiAgICB0aGlzLm15SGVhZGVycz0gew0KICAgICAgJ1Rva2VuJzpzdG9yYWdlLmdldCgiVG9rZW4iKQ0KICAgIH0NCiAgfSwNCiAgd2F0Y2g6IHsNCiAgICBmaWxlVXJsczogZnVuY3Rpb24odmFsLCBvbGRWYWwpIHsNCiAgICAgIC8vICAgY29uc29sZS5sb2coIm5ldzogJXMsIG9sZDogJXMiLCB2YWwsIG9sZFZhbCk7DQogICAgICB0aGlzLmluaXQoKTsNCiAgICB9DQogIH0sDQogIGNvbXB1dGVkOiB7DQogICAgLy8g6K6h566X5bGe5oCn55qEIGdldHRlcg0KICAgIGdldEFjdGlvblVybDogZnVuY3Rpb24oKSB7DQogICAgICByZXR1cm4gdGhpcy5iYXNlVXJsICsgIHRoaXMuYWN0aW9uOw0KICAgIH0NCiAgfSwNCiAgbWV0aG9kczogew0KICAgIC8vIOWIneWni+WMlg0KICAgIGluaXQoKSB7DQogICAgICBpZiAodGhpcy5maWxlVXJscykgew0KICAgICAgICB0aGlzLmZpbGVVcmxMaXN0ID0gdGhpcy5maWxlVXJscy5zcGxpdCgiLCIpOw0KICAgICAgICBsZXQgZmlsZUFycmF5ID0gW107DQogICAgICAgIHRoaXMuZmlsZVVybExpc3QuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpbmRleCkgew0KICAgICAgICAgIHZhciB1cmwgPSBpdGVtOw0KICAgICAgICAgIHZhciBuYW1lID0gaW5kZXg7DQogICAgICAgICAgdmFyIGZpbGUgPSB7DQogICAgICAgICAgICBuYW1lOiBuYW1lLA0KICAgICAgICAgICAgdXJsOiB1cmwNCiAgICAgICAgICB9Ow0KICAgICAgICAgIGZpbGVBcnJheS5wdXNoKGZpbGUpOw0KICAgICAgICB9KTsNCiAgICAgICAgdGhpcy5zZXRGaWxlTGlzdChmaWxlQXJyYXkpOw0KICAgICAgfQ0KICAgIH0sDQogICAgaGFuZGxlQmVmb3JlVXBsb2FkKGZpbGUpIHsNCgkNCiAgICB9LA0KICAgIC8vIOS4iuS8oOaWh+S7tuaIkOWKn+WQjuaJp+ihjA0KICAgIGhhbmRsZVVwbG9hZFN1Y2Nlc3MocmVzLCBmaWxlLCBmaWxlTGlzdCkgew0KICAgICAgaWYgKHJlcyAmJiByZXMuY29kZSA9PT0gMCkgew0KICAgICAgICBmaWxlTGlzdFtmaWxlTGlzdC5sZW5ndGggLSAxXVsidXJsIl0gPSAidXBsb2FkLyIgKyBmaWxlLnJlc3BvbnNlLmZpbGU7DQogICAgICAgIHRoaXMuc2V0RmlsZUxpc3QoZmlsZUxpc3QpOw0KICAgICAgICB0aGlzLiRlbWl0KCJjaGFuZ2UiLCB0aGlzLmZpbGVVcmxMaXN0LmpvaW4oIiwiKSk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5tc2cpOw0KICAgICAgfQ0KICAgIH0sDQogICAgLy8g5Zu+54mH5LiK5Lyg5aSx6LSlDQogICAgaGFuZGxlVXBsb2FkRXJyKGVyciwgZmlsZSwgZmlsZUxpc3QpIHsNCiAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIuaWh+S7tuS4iuS8oOWksei0pSIpOw0KICAgIH0sDQogICAgLy8g56e76Zmk5Zu+54mHDQogICAgaGFuZGxlUmVtb3ZlKGZpbGUsIGZpbGVMaXN0KSB7DQogICAgICB0aGlzLnNldEZpbGVMaXN0KGZpbGVMaXN0KTsNCiAgICAgIHRoaXMuJGVtaXQoImNoYW5nZSIsIHRoaXMuZmlsZVVybExpc3Quam9pbigiLCIpKTsNCiAgICB9LA0KICAgIC8vIOafpeeci+Wkp+Wbvg0KICAgIGhhbmRsZVVwbG9hZFByZXZpZXcoZmlsZSkgew0KICAgICAgdGhpcy5kaWFsb2dJbWFnZVVybCA9IGZpbGUudXJsOw0KICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gdHJ1ZTsNCiAgICB9LA0KICAgIC8vIOmZkOWItuWbvueJh+aVsOmHjw0KICAgIGhhbmRsZUV4Y2VlZChmaWxlcywgZmlsZUxpc3QpIHsNCiAgICAgIHRoaXMuJG1lc3NhZ2Uud2FybmluZyhg5pyA5aSa5LiK5LygJHt0aGlzLmxpbWl0feW8oOWbvueJh2ApOw0KICAgIH0sDQogICAgLy8g6YeN5paw5a+5ZmlsZUxpc3Tov5vooYzotYvlgLwNCiAgICBzZXRGaWxlTGlzdChmaWxlTGlzdCkgew0KICAgICAgdmFyIGZpbGVBcnJheSA9IFtdOw0KICAgICAgdmFyIGZpbGVVcmxBcnJheSA9IFtdOw0KICAgICAgLy8g5pyJ5Lqb5Zu+54mH5LiN5piv5YWs5byA55qE77yM5omA5Lul6ZyA6KaB5pC65bimdG9rZW7kv6Hmga/lgZrmnYPpmZDmoKHpqowNCiAgICAgIHZhciB0b2tlbiA9IHN0b3JhZ2UuZ2V0KCJ0b2tlbiIpOw0KICAgICAgbGV0IF90aGlzID0gdGhpczsNCiAgICAgIGZpbGVMaXN0LmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHsNCiAgICAgICAgdmFyIHVybCA9IGl0ZW0udXJsLnNwbGl0KCI/IilbMF07DQogICAgICAgIGlmKCF1cmwuc3RhcnRzV2l0aCgiaHR0cCIpKSB7DQogICAgICAgICAgdXJsID0gX3RoaXMuYmFzZVVybCArICB1cmwNCiAgICAgICAgfQ0KICAgICAgICB2YXIgbmFtZSA9IGl0ZW0ubmFtZTsNCiAgICAgICAgdmFyIGZpbGUgPSB7DQogICAgICAgICAgbmFtZTogbmFtZSwNCiAgICAgICAgICB1cmw6IHVybCArICI/dG9rZW49IiArIHRva2VuDQogICAgICAgIH07DQogICAgICAgIGZpbGVBcnJheS5wdXNoKGZpbGUpOw0KICAgICAgICBmaWxlVXJsQXJyYXkucHVzaCh1cmwpOw0KICAgICAgfSk7DQogICAgICB0aGlzLmZpbGVMaXN0ID0gZmlsZUFycmF5Ow0KICAgICAgdGhpcy5maWxlVXJsTGlzdCA9IGZpbGVVcmxBcnJheTsNCiAgICB9DQogIH0NCn07DQo="},{"version":3,"sources":["FileUpload.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"FileUpload.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div>\r\n    <!-- 上传文件组件 -->\r\n    <el-upload\r\n      ref=\"upload\"\r\n      :action=\"getActionUrl\"\r\n      list-type=\"picture-card\"\r\n      :multiple=\"multiple\"\r\n      :limit=\"limit\"\r\n      :headers=\"myHeaders\"\r\n      :file-list=\"fileList\"\r\n      :on-exceed=\"handleExceed\"\r\n      :on-preview=\"handleUploadPreview\"\r\n      :on-remove=\"handleRemove\"\r\n      :on-success=\"handleUploadSuccess\"\r\n      :on-error=\"handleUploadErr\"\r\n      :before-upload=\"handleBeforeUpload\"\r\n    >\r\n      <i class=\"el-icon-plus\"></i>\r\n      <div slot=\"tip\" class=\"el-upload__tip\" style=\"color:#838fa1;\">{{tip}}</div>\r\n    </el-upload>\r\n    <el-dialog :visible.sync=\"dialogVisible\" size=\"tiny\" append-to-body>\r\n      <img width=\"100%\" :src=\"dialogImageUrl\" alt>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport storage from \"@/common/storage\";\r\nimport config from \"@/config/config\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      baseUrl: config.baseUrl,\r\n      // 查看大图\r\n      dialogVisible: false,\r\n      // 查看大图\r\n      dialogImageUrl: \"\",\r\n      // 组件渲染图片的数组字段，有特殊格式要求\r\n      fileList: [],\r\n      fileUrlList: [],\r\n      myHeaders:{}\r\n    };\r\n  },\r\n  props: [\"tip\", \"action\", \"limit\", \"multiple\", \"fileUrls\"],\r\n  mounted() {\r\n    this.init();\r\n    this.myHeaders= {\r\n      'Token':storage.get(\"Token\")\r\n    }\r\n  },\r\n  watch: {\r\n    fileUrls: function(val, oldVal) {\r\n      //   console.log(\"new: %s, old: %s\", val, oldVal);\r\n      this.init();\r\n    }\r\n  },\r\n  computed: {\r\n    // 计算属性的 getter\r\n    getActionUrl: function() {\r\n      return this.baseUrl +  this.action;\r\n    }\r\n  },\r\n  methods: {\r\n    // 初始化\r\n    init() {\r\n      if (this.fileUrls) {\r\n        this.fileUrlList = this.fileUrls.split(\",\");\r\n        let fileArray = [];\r\n        this.fileUrlList.forEach(function(item, index) {\r\n          var url = item;\r\n          var name = index;\r\n          var file = {\r\n            name: name,\r\n            url: url\r\n          };\r\n          fileArray.push(file);\r\n        });\r\n        this.setFileList(fileArray);\r\n      }\r\n    },\r\n    handleBeforeUpload(file) {\r\n\t\r\n    },\r\n    // 上传文件成功后执行\r\n    handleUploadSuccess(res, file, fileList) {\r\n      if (res && res.code === 0) {\r\n        fileList[fileList.length - 1][\"url\"] = \"upload/\" + file.response.file;\r\n        this.setFileList(fileList);\r\n        this.$emit(\"change\", this.fileUrlList.join(\",\"));\r\n      } else {\r\n        this.$message.error(res.msg);\r\n      }\r\n    },\r\n    // 图片上传失败\r\n    handleUploadErr(err, file, fileList) {\r\n      this.$message.error(\"文件上传失败\");\r\n    },\r\n    // 移除图片\r\n    handleRemove(file, fileList) {\r\n      this.setFileList(fileList);\r\n      this.$emit(\"change\", this.fileUrlList.join(\",\"));\r\n    },\r\n    // 查看大图\r\n    handleUploadPreview(file) {\r\n      this.dialogImageUrl = file.url;\r\n      this.dialogVisible = true;\r\n    },\r\n    // 限制图片数量\r\n    handleExceed(files, fileList) {\r\n      this.$message.warning(`最多上传${this.limit}张图片`);\r\n    },\r\n    // 重新对fileList进行赋值\r\n    setFileList(fileList) {\r\n      var fileArray = [];\r\n      var fileUrlArray = [];\r\n      // 有些图片不是公开的，所以需要携带token信息做权限校验\r\n      var token = storage.get(\"token\");\r\n      let _this = this;\r\n      fileList.forEach(function(item, index) {\r\n        var url = item.url.split(\"?\")[0];\r\n        if(!url.startsWith(\"http\")) {\r\n          url = _this.baseUrl +  url\r\n        }\r\n        var name = item.name;\r\n        var file = {\r\n          name: name,\r\n          url: url + \"?token=\" + token\r\n        };\r\n        fileArray.push(file);\r\n        fileUrlArray.push(url);\r\n      });\r\n      this.fileList = fileArray;\r\n      this.fileUrlList = fileUrlArray;\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n</style>\r\n"]}]}